<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Japanisch A1a ‚Äì Vokabeltrainer</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Inter:wght@400;500;600;700&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', sans-serif;
    background: #0f0f13;
    color: #e8e6e3;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .app { max-width: 540px; margin: 0 auto; padding: 16px; min-height: 100vh; display: flex; flex-direction: column; }

  /* Header */
  .header { text-align: center; padding: 20px 0 12px; }
  .header h1 { font-size: 1.3rem; font-weight: 700; color: #fff; margin-bottom: 4px; }
  .header .sub { font-size: 0.8rem; color: #888; }

  /* Category selector */
  .cat-scroll { display: flex; gap: 8px; overflow-x: auto; padding: 12px 0; scrollbar-width: none; -ms-overflow-style: none; }
  .cat-scroll::-webkit-scrollbar { display: none; }
  .cat-btn {
    flex-shrink: 0; padding: 7px 14px; border-radius: 20px; border: 1px solid #2a2a35;
    background: #1a1a24; color: #aaa; font-size: 0.78rem; cursor: pointer;
    transition: all 0.2s; white-space: nowrap; font-family: 'Inter', sans-serif;
  }
  .cat-btn:hover { border-color: #e74c6f; color: #e74c6f; }
  .cat-btn.active { background: #e74c6f; border-color: #e74c6f; color: #fff; }

  /* Mode tabs */
  .mode-tabs { display: flex; gap: 6px; justify-content: center; margin: 10px 0 14px; }
  .mode-tab {
    padding: 6px 16px; border-radius: 8px; border: none; background: #1a1a24;
    color: #888; font-size: 0.78rem; cursor: pointer; font-family: 'Inter', sans-serif; transition: all 0.2s;
  }
  .mode-tab.active { background: #2a2a3a; color: #fff; }

  /* Stats bar */
  .stats {
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px 16px; background: #1a1a24; border-radius: 12px; margin-bottom: 14px;
    font-size: 0.8rem;
  }
  .stats .progress-wrap { flex: 1; margin: 0 16px; }
  .progress-bar { height: 6px; background: #2a2a35; border-radius: 3px; overflow: hidden; }
  .progress-fill { height: 100%; background: linear-gradient(90deg, #e74c6f, #f59e0b); border-radius: 3px; transition: width 0.4s ease; }
  .stat-num { font-weight: 700; color: #fff; }
  .stat-label { color: #666; font-size: 0.7rem; }

  /* Flashcard */
  .card-container { flex: 1; display: flex; align-items: center; justify-content: center; perspective: 1000px; padding: 10px 0; }
  .card-wrapper { width: 100%; max-width: 420px; aspect-ratio: 3/2; position: relative; }

  .card {
    width: 100%; height: 100%; position: relative;
    transform-style: preserve-3d; transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }
  .card.flipped { transform: rotateY(180deg); }

  .card-face {
    position: absolute; width: 100%; height: 100%;
    backface-visibility: hidden; -webkit-backface-visibility: hidden;
    border-radius: 20px; display: flex; flex-direction: column;
    align-items: center; justify-content: center; padding: 24px;
    border: 1px solid #2a2a35;
  }

  .card-front {
    background: linear-gradient(145deg, #1e1e2e, #16162a);
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  }
  .card-back {
    background: linear-gradient(145deg, #1a2e1e, #162a1e);
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    transform: rotateY(180deg);
  }

  .card-label { font-size: 0.7rem; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
  .card-jp { font-family: 'Noto Sans JP', sans-serif; font-size: 2.4rem; font-weight: 700; color: #fff; text-align: center; line-height: 1.3; }
  .card-romaji { font-size: 1rem; color: #e74c6f; margin-top: 8px; }
  .card-de { font-size: 1.8rem; font-weight: 600; color: #4ade80; text-align: center; }
  .card-de-small { font-size: 0.9rem; color: #88c090; margin-top: 6px; }
  .tap-hint { font-size: 0.7rem; color: #444; position: absolute; bottom: 16px; }

  /* Direction indicator */
  .direction-info { text-align: center; font-size: 0.72rem; color: #555; margin-bottom: 6px; }

  /* Buttons */
  .btn-row { display: flex; gap: 12px; padding: 16px 0 24px; justify-content: center; }
  .btn {
    flex: 1; max-width: 180px; padding: 14px 20px; border-radius: 14px; border: none;
    font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.2s;
    font-family: 'Inter', sans-serif;
  }
  .btn-again { background: #3a1a24; color: #f87171; }
  .btn-again:hover { background: #4a2030; }
  .btn-good { background: #1a3a24; color: #4ade80; }
  .btn-good:hover { background: #204a2e; }
  .btn:disabled { opacity: 0.3; cursor: default; }

  /* Done screen */
  .done-screen { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
  .done-emoji { font-size: 3rem; margin-bottom: 16px; }
  .done-title { font-size: 1.5rem; font-weight: 700; color: #fff; margin-bottom: 8px; }
  .done-text { color: #888; font-size: 0.9rem; margin-bottom: 6px; }
  .done-stats { display: flex; gap: 24px; margin: 20px 0; }
  .done-stat { text-align: center; }
  .done-stat .num { font-size: 2rem; font-weight: 700; }
  .done-stat .lbl { font-size: 0.75rem; color: #888; }
  .btn-restart {
    margin-top: 16px; padding: 12px 32px; border-radius: 12px; border: none;
    background: #e74c6f; color: #fff; font-size: 0.9rem; font-weight: 600;
    cursor: pointer; font-family: 'Inter', sans-serif;
  }
  .btn-restart:hover { background: #d43d60; }
  .btn-restart-sec {
    margin-top: 10px; padding: 10px 28px; border-radius: 12px; border: 1px solid #2a2a35;
    background: transparent; color: #aaa; font-size: 0.82rem; cursor: pointer;
    font-family: 'Inter', sans-serif;
  }

  /* Keyboard shortcuts hint */
  .shortcuts { text-align: center; font-size: 0.68rem; color: #444; padding-bottom: 12px; }
  .shortcuts kbd { background: #1a1a24; padding: 2px 6px; border-radius: 4px; border: 1px solid #2a2a35; margin: 0 2px; }

  /* Shuffle indicator */
  .shuffle-toggle {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    font-size: 0.75rem; color: #666; margin-bottom: 8px; cursor: pointer; user-select: none;
  }
  .shuffle-toggle input { accent-color: #e74c6f; }
</style>
</head>
<body>
<div class="app" id="app"></div>

<script>
const VOCAB = {
  "Personen & Berufe": [
    {jp:"„Åπ„Çì„Åî„Åó",rm:"bengoshi",de:"Rechtsanwalt"},
    {jp:"„Å≤„Åó„Çá",rm:"hisho",de:"Sekret√§r/in"},
    {jp:"„Åå„Åè„Åõ„ÅÑ",rm:"gakusei",de:"Student/in"},
    {jp:"„Åã„ÅÑ„Åó„ÇÉ„ÅÑ„Çì",rm:"kaishain",de:"Firmenangestellte/r"},
    {jp:"„Åé„Çì„Åì„ÅÜ„ÅÑ„Çì",rm:"gink√¥in",de:"Bankangestellte/r"},
    {jp:"„Åü„ÅÑ„Åó",rm:"taishi",de:"Botschafter"},
    {jp:"„Åõ„Çì„Åõ„ÅÑ",rm:"sensei",de:"Lehrer/in"},
    {jp:"„Å¶„Çì„ÅÑ„Çì",rm:"ten'in",de:"Verk√§ufer/in"},
    {jp:"„Å®„ÇÇ„Å†„Å°",rm:"tomodachi",de:"Freund/in"},
    {jp:"„Åä„Å®„Åì„ÅÆ„Å≤„Å®",rm:"otoko no hito",de:"Mann"},
    {jp:"„Åä„Çì„Å™„ÅÆ„Å≤„Å®",rm:"onna no hito",de:"Frau"},
    {jp:"„Çè„Åü„Åó",rm:"watashi",de:"ich"},
    {jp:"„ÅÇ„Å™„Åü",rm:"anata",de:"Sie / du"},
    {jp:"„Åì„Å°„Çâ",rm:"kochira",de:"diese Person hier (h√∂flich)"},
  ],
  "L√§nder & Nationalit√§ten": [
    {jp:"„Å´„Åª„Çì",rm:"Nihon",de:"Japan"},
    {jp:"„Éâ„Ç§„ÉÑ",rm:"Doitsu",de:"Deutschland"},
    {jp:"„Å°„ÇÖ„ÅÜ„Åî„Åè",rm:"Ch√ªgoku",de:"China"},
    {jp:"„Ç¢„É°„É™„Ç´",rm:"Amerika",de:"Amerika"},
    {jp:"„Ç§„ÇÆ„É™„Çπ",rm:"Igirisu",de:"England"},
    {jp:"„Éï„É©„É≥„Çπ",rm:"Furansu",de:"Frankreich"},
    {jp:"„Ç§„Çø„É™„Ç¢",rm:"Itaria",de:"Italien"},
    {jp:"„Åã„Çì„Åì„Åè",rm:"Kankoku",de:"S√ºdkorea"},
    {jp:"„Å´„Åª„Çì„Åò„Çì",rm:"Nihon-jin",de:"Japaner/in"},
    {jp:"„Éâ„Ç§„ÉÑ„Åò„Çì",rm:"Doitsu-jin",de:"Deutsche/r"},
    {jp:"„Å°„ÇÖ„ÅÜ„Åî„Åè„Åò„Çì",rm:"Ch√ªgoku-jin",de:"Chinese/Chinesin"},
    {jp:"„Ç¢„É°„É™„Ç´„Åò„Çì",rm:"Amerika-jin",de:"Amerikaner/in"},
    {jp:"„Ç§„ÇÆ„É™„Çπ„Åò„Çì",rm:"Igirisu-jin",de:"Engl√§nder/in"},
    {jp:"„Éï„É©„É≥„Çπ„Åò„Çì",rm:"Furansu-jin",de:"Franzose/Franz√∂sin"},
    {jp:"„Ç§„Çø„É™„Ç¢„Åò„Çì",rm:"Itaria-jin",de:"Italiener/in"},
    {jp:"„Åã„Çì„Åì„Åè„Åò„Çì",rm:"Kankoku-jin",de:"S√ºdkoreaner/in"},
  ],
  "Sprachen": [
    {jp:"„Å´„Åª„Çì„Åî",rm:"Nihon-go",de:"Japanisch"},
    {jp:"„Éâ„Ç§„ÉÑ„Åî",rm:"Doitsu-go",de:"Deutsch"},
    {jp:"„Åà„ÅÑ„Åî",rm:"Eigo",de:"Englisch"},
    {jp:"„Éï„É©„É≥„Çπ„Åî",rm:"Furansu-go",de:"Franz√∂sisch"},
    {jp:"„Å°„ÇÖ„ÅÜ„Åî„Åè„Åî",rm:"Ch√ªgoku-go",de:"Chinesisch"},
    {jp:"„Ç§„Çø„É™„Ç¢„Åî",rm:"Itaria-go",de:"Italienisch"},
    {jp:"„Åã„Çì„Åì„Åè„Åî",rm:"Kankoku-go",de:"Koreanisch"},
  ],
  "Gegenst√§nde": [
    {jp:"„ÇÅ„ÅÑ„Åó",rm:"meishi",de:"Visitenkarte"},
    {jp:"„Åª„Çì",rm:"hon",de:"Buch"},
    {jp:"„Åó„Çì„Å∂„Çì",rm:"shinbun",de:"Zeitung"},
    {jp:"„Åñ„Å£„Åó",rm:"zasshi",de:"Zeitschrift"},
    {jp:"„Å®„Åë„ÅÑ",rm:"tokei",de:"Uhr"},
    {jp:"„Åã„Åé",rm:"kagi",de:"Schl√ºssel"},
    {jp:"„Åß„Çì„Çè",rm:"denwa",de:"Telefon"},
    {jp:"„Åè„Çã„Åæ",rm:"kuruma",de:"Auto"},
    {jp:"„Çπ„Éû„Éõ",rm:"sumaho",de:"Smartphone"},
    {jp:"„Éö„É≥",rm:"pen",de:"Stift"},
    {jp:"„Åã„Åï",rm:"kasa",de:"Regenschirm"},
    {jp:"„Åã„Å∞„Çì",rm:"kaban",de:"Tasche"},
    {jp:"„ÉÜ„É¨„Éì",rm:"terebi",de:"Fernseher"},
    {jp:"„É©„Ç∏„Ç™",rm:"rajio",de:"Radio"},
    {jp:"„Ç´„É°„É©",rm:"kamera",de:"Kamera"},
    {jp:"„ÅØ„ÅÑ„Åñ„Çâ",rm:"haizara",de:"Aschenbecher"},
    {jp:"„É¨„Ç∑„Éº„Éà",rm:"resh√Æto",de:"Quittung"},
    {jp:"„Åç„Å£„Å¶",rm:"kitte",de:"Briefmarke"},
    {jp:"„ÅØ„Åå„Åç",rm:"hagaki",de:"Postkarte"},
    {jp:"„Çª„Éº„Çø„Éº",rm:"s√™t√¢",de:"Pullover"},
    {jp:"„Éê„Éä„Éä",rm:"banana",de:"Banane"},
    {jp:"„Çä„Çì„Åî",rm:"ringo",de:"Apfel"},
    {jp:"„Åø„Åã„Çì",rm:"mikan",de:"Mandarine"},
    {jp:"„Åø„Åö",rm:"mizu",de:"Wasser"},
    {jp:"„Ç≥„Éº„Éí„Éº",rm:"k√¥h√Æ",de:"Kaffee"},
    {jp:"„Åä„Å°„ÇÉ",rm:"o-cha",de:"Tee"},
    {jp:"„Éì„Éº„É´",rm:"b√Æru",de:"Bier"},
    {jp:"„Ç∏„É•„Éº„Çπ",rm:"j√ªsu",de:"Saft"},
    {jp:"„ÉØ„Ç§„É≥",rm:"wain",de:"Wein"},
    {jp:"„Éù„Çπ„Éà",rm:"posuto",de:"Briefkasten"},
    {jp:"„Éê„Çπ",rm:"basu",de:"Bus"},
    {jp:"„Å≤„Åì„ÅÜ„Åç",rm:"hik√¥ki",de:"Flugzeug"},
    {jp:"„Çø„ÇØ„Ç∑„Éº",rm:"takush√Æ",de:"Taxi"},
    {jp:"„ÉÜ„Éº„Éñ„É´",rm:"t√™buru",de:"Tisch"},
    {jp:"„Åß„Çì„Å°",rm:"denchi",de:"Batterie"},
    {jp:"„Éï„Ç£„É´„É†",rm:"fuirumu",de:"Film (Kamera)"},
    {jp:"„ÉÜ„Éº„Éó",rm:"t√™pu",de:"Kassette"},
  ],
  "Geb√§ude & Orte": [
    {jp:"„Åã„ÅÑ„Åó„ÇÉ",rm:"kaisha",de:"Firma"},
    {jp:"„Åå„Å£„Åì„ÅÜ",rm:"gakk√¥",de:"Schule"},
    {jp:"„Å†„ÅÑ„Åå„Åè",rm:"daigaku",de:"Universit√§t"},
    {jp:"„ÅÜ„Å°",rm:"uchi",de:"Zuhause / Haus"},
    {jp:"„Åü„ÅÑ„Åó„Åã„Çì",rm:"taishikan",de:"Botschaft"},
    {jp:"„Åé„Çì„Åì„ÅÜ",rm:"gink√¥",de:"Bank"},
    {jp:"„ÇÜ„ÅÜ„Å≥„Çì„Åç„Çá„Åè",rm:"y√ªbinkyoku",de:"Postamt"},
    {jp:"„Éá„Éë„Éº„Éà",rm:"dep√¢to",de:"Kaufhaus"},
    {jp:"„Åç„Å£„Åï„Å¶„Çì",rm:"kissaten",de:"Caf√©"},
    {jp:"„Åà„Åç",rm:"eki",de:"Bahnhof"},
    {jp:"„Åè„ÅÜ„Åì„ÅÜ",rm:"k√ªk√¥",de:"Flughafen"},
    {jp:"„Åó„Åó„ÇÉ",rm:"shisha",de:"Niederlassung"},
    {jp:"„Éõ„ÉÜ„É´",rm:"hoteru",de:"Hotel"},
    {jp:"„É¨„Çπ„Éà„É©„É≥",rm:"resutoran",de:"Restaurant"},
    {jp:"„Çπ„Éº„Éë„Éº",rm:"s√ªp√¢",de:"Supermarkt"},
    {jp:"„Ç´„É°„É©„ÇÑ",rm:"kamera-ya",de:"Kameraladen"},
    {jp:"„ÅØ„Å™„ÇÑ",rm:"hana-ya",de:"Blumenladen"},
    {jp:"„Åï„Åã„Å™„ÇÑ",rm:"sakana-ya",de:"Fischladen"},
    {jp:"„Åª„Çì„ÇÑ",rm:"hon-ya",de:"Buchladen"},
  ],
  "Zeitangaben": [
    {jp:"„ÅÑ„Åæ",rm:"ima",de:"jetzt"},
    {jp:"„Åç„Çá„ÅÜ",rm:"ky√¥",de:"heute"},
    {jp:"„ÅÇ„Åó„Åü",rm:"ashita",de:"morgen"},
    {jp:"„ÅÇ„Åï„Å£„Å¶",rm:"asatte",de:"√ºbermorgen"},
    {jp:"„Åç„ÅÆ„ÅÜ",rm:"kin√¥",de:"gestern"},
    {jp:"„Åä„Å®„Å®„ÅÑ",rm:"ototoi",de:"vorgestern"},
    {jp:"„Å≤„Çã",rm:"hiru",de:"Mittag"},
    {jp:"„Åî„Åú„Çì",rm:"gozen",de:"Vormittag / AM"},
    {jp:"„Åî„Åî",rm:"gogo",de:"Nachmittag / PM"},
    {jp:"„Çâ„ÅÑ„Åó„ÇÖ„ÅÜ",rm:"raish√ª",de:"n√§chste Woche"},
    {jp:"„Åì„Çì„Åó„ÇÖ„ÅÜ",rm:"konsh√ª",de:"diese Woche"},
    {jp:"„Åõ„Çì„Åó„ÇÖ„ÅÜ",rm:"sensh√ª",de:"letzte Woche"},
    {jp:"„Åó„ÇÖ„ÅÜ„Åæ„Å§",rm:"sh√ªmatsu",de:"Wochenende"},
    {jp:"„Åì„Çì„Åí„Å§",rm:"kongetsu",de:"dieser Monat"},
  ],
  "Wochentage": [
    {jp:"„Å´„Å°„Çà„ÅÜ„Å≥",rm:"nichiy√¥bi",de:"Sonntag"},
    {jp:"„Åí„Å§„Çà„ÅÜ„Å≥",rm:"getsuy√¥bi",de:"Montag"},
    {jp:"„Åã„Çà„ÅÜ„Å≥",rm:"kay√¥bi",de:"Dienstag"},
    {jp:"„Åô„ÅÑ„Çà„ÅÜ„Å≥",rm:"suiy√¥bi",de:"Mittwoch"},
    {jp:"„ÇÇ„Åè„Çà„ÅÜ„Å≥",rm:"mokuy√¥bi",de:"Donnerstag"},
    {jp:"„Åç„Çì„Çà„ÅÜ„Å≥",rm:"kin'y√¥bi",de:"Freitag"},
    {jp:"„Å©„Çà„ÅÜ„Å≥",rm:"doy√¥bi",de:"Samstag"},
  ],
  "Monate": [
    {jp:"„ÅÑ„Å°„Åå„Å§",rm:"ichi-gatsu",de:"Januar"},
    {jp:"„Å´„Åå„Å§",rm:"ni-gatsu",de:"Februar"},
    {jp:"„Åï„Çì„Åå„Å§",rm:"san-gatsu",de:"M√§rz"},
    {jp:"„Åó„Åå„Å§",rm:"shi-gatsu",de:"April"},
    {jp:"„Åî„Åå„Å§",rm:"go-gatsu",de:"Mai"},
    {jp:"„Çç„Åè„Åå„Å§",rm:"roku-gatsu",de:"Juni"},
    {jp:"„Åó„Å°„Åå„Å§",rm:"shichi-gatsu",de:"Juli"},
    {jp:"„ÅØ„Å°„Åå„Å§",rm:"hachi-gatsu",de:"August"},
    {jp:"„Åè„Åå„Å§",rm:"ku-gatsu",de:"September"},
    {jp:"„Åò„ÇÖ„ÅÜ„Åå„Å§",rm:"j√ª-gatsu",de:"Oktober"},
    {jp:"„Åò„ÇÖ„ÅÜ„ÅÑ„Å°„Åå„Å§",rm:"j√ªichi-gatsu",de:"November"},
    {jp:"„Åò„ÇÖ„ÅÜ„Å´„Åå„Å§",rm:"j√ªni-gatsu",de:"Dezember"},
  ],
  "Verben": [
    {jp:"„Åß„Åô",rm:"desu",de:"sein (Kopula)"},
    {jp:"„Åß„Åó„Åü",rm:"deshita",de:"war (Verg. von desu)"},
    {jp:"„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì",rm:"de wa arimasen",de:"ist nicht (Neg. von desu)"},
    {jp:"„Åó„Åæ„Åô",rm:"shimasu",de:"machen, tun"},
    {jp:"„Åè„Å†„Åï„ÅÑ",rm:"kudasai",de:"bitte geben Sie"},
    {jp:"„ÅÑ„Åç„Åæ„Åô",rm:"ikimasu",de:"(hin)gehen, fahren"},
    {jp:"„Åç„Åæ„Åô",rm:"kimasu",de:"kommen"},
    {jp:"„Åã„Åà„Çä„Åæ„Åô",rm:"kaerimasu",de:"zur√ºckkehren"},
  ],
  "Fragew√∂rter": [
    {jp:"„Å©„Å™„Åü",rm:"donata",de:"Wer? (h√∂flich)"},
    {jp:"„Å†„Çå",rm:"dare",de:"Wer?"},
    {jp:"„Å†„Çå„ÅÆ",rm:"dare no",de:"Wessen?"},
    {jp:"„Å™„Çì / „Å™„Å´",rm:"nan / nani",de:"Was?"},
    {jp:"„Å™„Çì„Å∞„Çì",rm:"nan-ban",de:"Welche Nummer?"},
    {jp:"„Å™„Çì„Åò",rm:"nan-ji",de:"Wie viel Uhr?"},
    {jp:"„Å©„Çå",rm:"dore",de:"Welches?"},
    {jp:"„Å©„ÅÆ",rm:"dono",de:"Welches? (vor Nomen)"},
    {jp:"„Å™„Çì„Çà„ÅÜ„Å≥",rm:"nan-y√¥bi",de:"Welcher Wochentag?"},
    {jp:"„Å™„Çì„Å´„Å°",rm:"nan-nichi",de:"Welcher Tag?"},
    {jp:"„Å™„Çì„Åå„Å§",rm:"nan-gatsu",de:"Welcher Monat?"},
    {jp:"„ÅÑ„Å§",rm:"itsu",de:"Wann?"},
    {jp:"„ÅÑ„Åè„Çâ",rm:"ikura",de:"Wie viel? / Wie teuer?"},
    {jp:"„Å©„Åì",rm:"doko",de:"Wo?"},
    {jp:"„Å©„Åì„ÅÆ",rm:"doko no",de:"Woher?"},
    {jp:"„Å©„Åì„Å´",rm:"doko ni",de:"Wohin?"},
  ],
  "Partikeln": [
    {jp:"„ÅØ",rm:"wa",de:"Themapartikel"},
    {jp:"„ÅÆ",rm:"no",de:"Genitiv / Possessiv"},
    {jp:"„Åã",rm:"ka",de:"Fragepartikel"},
    {jp:"„Åã„Çâ",rm:"kara",de:"von / ab"},
    {jp:"„Åæ„Åß",rm:"made",de:"bis"},
    {jp:"„ÇÇ",rm:"mo",de:"auch"},
    {jp:"„Çí",rm:"o",de:"Akkusativ (Objekt)"},
    {jp:"„Å®",rm:"to",de:"und / mit"},
    {jp:"„Å´",rm:"ni",de:"Richtung (nach, zu, in)"},
  ],
  "Adjektive": [
    {jp:"„ÅÇ„Åã„ÅÑ",rm:"akai",de:"rot"},
    {jp:"„ÅÇ„Åä„ÅÑ",rm:"aoi",de:"blau"},
    {jp:"„Åè„Çç„ÅÑ",rm:"kuroi",de:"schwarz"},
    {jp:"„Åä„Åä„Åç„ÅÑ",rm:"√¥kii",de:"gro√ü"},
    {jp:"„Å°„ÅÑ„Åï„ÅÑ",rm:"chiisai",de:"klein"},
  ],
  "Demonstrativpronomen": [
    {jp:"„Åì„Çå",rm:"kore",de:"dieses hier"},
    {jp:"„Åù„Çå",rm:"sore",de:"dieses dort (bei dir)"},
    {jp:"„ÅÇ„Çå",rm:"are",de:"jenes dort dr√ºben"},
    {jp:"„Å©„Çå",rm:"dore",de:"welches?"},
    {jp:"„Åì„ÅÆ",rm:"kono",de:"dieser (+ Nomen)"},
    {jp:"„Åù„ÅÆ",rm:"sono",de:"jener bei dir (+ Nomen)"},
    {jp:"„ÅÇ„ÅÆ",rm:"ano",de:"jener dort (+ Nomen)"},
    {jp:"„Å©„ÅÆ",rm:"dono",de:"welcher? (+ Nomen)"},
  ],
  "Ausdr√ºcke & Floskeln": [
    {jp:"„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô",rm:"ohay√¥ gozaimasu",de:"Guten Morgen"},
    {jp:"„Åì„Çì„Å´„Å°„ÅØ",rm:"kon'nichi wa",de:"Guten Tag"},
    {jp:"„Åì„Çì„Å∞„Çì„ÅØ",rm:"konban wa",de:"Guten Abend"},
    {jp:"„Åä„ÇÑ„Åô„Åø„Å™„Åï„ÅÑ",rm:"oyasumi nasai",de:"Gute Nacht"},
    {jp:"„Åï„Çà„ÅÜ„Å™„Çâ",rm:"say√¥nara",de:"Auf Wiedersehen"},
    {jp:"„Åò„ÇÉ„Åæ„Åü",rm:"j√¢ mata",de:"Bis dann"},
    {jp:"„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô",rm:"arigat√¥ gozaimasu",de:"Vielen Dank"},
    {jp:"„Å©„ÅÜ„ÅÑ„Åü„Åó„Åæ„Åó„Å¶",rm:"d√¥ itashimashite",de:"Bitte (Antwort auf Dank)"},
    {jp:"„Åô„Åø„Åæ„Åõ„Çì",rm:"sumimasen",de:"Entschuldigung"},
    {jp:"„ÅØ„Åò„ÇÅ„Åæ„Åó„Å¶",rm:"hajimemashite",de:"Freut mich (erste Begegnung)"},
    {jp:"„Å©„ÅÜ„Åû„Çà„Çç„Åó„Åè",rm:"d√¥zo yoroshiku",de:"Freut mich, Sie kennenzulernen"},
    {jp:"„ÅÑ„Çâ„Å£„Åó„ÇÉ„ÅÑ„Åæ„Åõ",rm:"irasshaimase",de:"Willkommen! (Gesch√§ft)"},
    {jp:"„Åî„Åó„Çá„ÅÜ„Åã„ÅÑ„Åó„Åæ„Åô",rm:"go-sh√¥kai shimasu",de:"Darf ich vorstellen"},
    {jp:"„ÅØ„ÅÑ",rm:"hai",de:"Ja"},
    {jp:"„ÅÑ„ÅÑ„Åà",rm:"iie",de:"Nein"},
    {jp:"„Åà„Åà",rm:"ee",de:"Ja (informell)"},
    {jp:"„Åù„ÅÜ„Åß„Åô",rm:"s√¥ desu",de:"Das stimmt"},
    {jp:"„Å©„ÅÜ„Åû",rm:"d√¥zo",de:"Bitte (anbietend)"},
  ],
  "T√§tigkeiten & Sonstiges": [
    {jp:"„Åó„Åî„Å®",rm:"shigoto",de:"Arbeit"},
    {jp:"„Åã„ÅÑ„Åé",rm:"kaigi",de:"Besprechung"},
    {jp:"„Åà„ÅÑ„Åå",rm:"eiga",de:"Film / Kino"},
    {jp:"„Åó„ÇÖ„Å£„Å°„Çá„ÅÜ",rm:"shutch√¥",de:"Gesch√§ftsreise"},
    {jp:"„Éë„Éº„ÉÜ„Ç£„Éº",rm:"p√¢t√Æ",de:"Party"},
    {jp:"„Ç¥„É´„Éï",rm:"gorufu",de:"Golf"},
    {jp:"„ÉÜ„Éã„Çπ",rm:"tenisu",de:"Tennis"},
    {jp:"„Åπ„Çì„Åç„Çá„ÅÜ",rm:"benky√¥",de:"Lernen / Studium"},
    {jp:"„Å≤„Çã„ÇÑ„Åô„Åø",rm:"hiru yasumi",de:"Mittagspause"},
    {jp:"„Å™„Å§„ÇÑ„Åô„Åø",rm:"natsu yasumi",de:"Sommerferien"},
    {jp:"„ÇÑ„Åô„Åø",rm:"yasumi",de:"Pause / Ferien"},
    {jp:"„Åü„Çì„Åò„Çá„ÅÜ„Å≥",rm:"tanj√¥bi",de:"Geburtstag"},
    {jp:"„Å™„Åæ„Åà",rm:"namae",de:"Name"},
    {jp:"„Åò„ÇÖ„ÅÜ„Åó„Çá",rm:"j√ªsho",de:"Adresse"},
    {jp:"„Åß„Çì„Çè„Å∞„Çì„Åî„ÅÜ",rm:"denwa bang√¥",de:"Telefonnummer"},
    {jp:"„Åß„ÅØ",rm:"dewa",de:"dann / also"},
    {jp:"„Åù„Çå„Åã„Çâ",rm:"sorekara",de:"danach"},
    {jp:"„Åù„Åó„Å¶",rm:"soshite",de:"und dann"},
    {jp:"„ÅÑ„Å£„Åó„Çá„Å´",rm:"isshoni",de:"zusammen"},
    {jp:"„Å≤„Å®„Çä„Åß",rm:"hitori de",de:"allein"},
    {jp:"„Åä„Åã„ÅÇ„Åï„Çì",rm:"ok√¢san",de:"Mutter"},
    {jp:"„Åä„Å≠„Åà„Åï„Çì",rm:"on√™san",de:"√§ltere Schwester"},
    {jp:"„ÅØ„Çì",rm:"han",de:"halb (Uhrzeit)"},
    {jp:"~„Åà„Çì",rm:"~en",de:"Yen"},
  ],
};

// State
let currentCat = "Alle";
let mode = "jp-de"; // jp-de or de-jp
let shuffle = true;
let deck = [];
let currentIndex = 0;
let flipped = false;
let knownCount = 0;
let againCount = 0;
let againPile = [];
let done = false;
let reviewingAgain = false;

function getAllVocab() {
  let all = [];
  for (const cat in VOCAB) all = all.concat(VOCAB[cat]);
  return all;
}

function shuffleArray(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; }
  return a;
}

function buildDeck() {
  let items = currentCat === "Alle" ? getAllVocab() : (VOCAB[currentCat] || []);
  deck = shuffle ? shuffleArray(items) : [...items];
  currentIndex = 0; flipped = false; knownCount = 0; againCount = 0; againPile = []; done = false; reviewingAgain = false;
}

function flipCard() { flipped = !flipped; render(); }

function markKnown() {
  if (!flipped) return;
  knownCount++;
  nextCard();
}

function markAgain() {
  if (!flipped) return;
  againCount++;
  againPile.push(deck[currentIndex]);
  nextCard();
}

function nextCard() {
  currentIndex++;
  flipped = false;
  if (currentIndex >= deck.length) {
    if (againPile.length > 0 && !reviewingAgain) {
      reviewingAgain = true;
      deck = shuffle ? shuffleArray(againPile) : [...againPile];
      againPile = [];
      currentIndex = 0;
      againCount = 0;
    } else if (againPile.length > 0 && reviewingAgain) {
      deck = shuffle ? shuffleArray(againPile) : [...againPile];
      againPile = [];
      currentIndex = 0;
      againCount = 0;
    } else {
      done = true;
    }
  }
  render();
}

function render() {
  const app = document.getElementById('app');
  const cats = ["Alle", ...Object.keys(VOCAB)];
  const total = deck.length;
  const progress = total > 0 ? ((currentIndex) / total * 100) : 0;
  const current = deck[currentIndex];

  let front, back, frontLabel, backLabel;
  if (current) {
    if (mode === "jp-de") {
      front = current.jp; frontLabel = "Japanisch"; back = current.de; backLabel = "Deutsch";
    } else {
      front = current.de; frontLabel = "Deutsch"; back = current.jp; backLabel = "Japanisch";
    }
  }

  if (done) {
    const totalAnswered = knownCount + againCount;
    app.innerHTML = `
      <div class="header"><h1>Japanisch A1a Vokabeltrainer</h1></div>
      <div class="done-screen">
        <div class="done-emoji">üéâ</div>
        <div class="done-title">${reviewingAgain ? 'Wiederholung fertig!' : 'Geschafft!'}</div>
        <div class="done-text">Alle Karten in "${currentCat}" durchgearbeitet</div>
        <div class="done-stats">
          <div class="done-stat"><div class="num" style="color:#4ade80">${knownCount}</div><div class="lbl">Gewusst</div></div>
          <div class="done-stat"><div class="num" style="color:#f87171">${againCount}</div><div class="lbl">Nochmal</div></div>
        </div>
        <button class="btn-restart" onclick="buildDeck(); render();">Nochmal lernen</button>
        <button class="btn-restart-sec" onclick="currentCat='Alle'; buildDeck(); render();">Alle Kategorien</button>
      </div>
    `;
    return;
  }

  app.innerHTML = `
    <div class="header">
      <h1>Êó•Êú¨Ë™û Vokabeltrainer</h1>
      <div class="sub">A1a ‚Äì Lektionen 1‚Äì6 ¬∑ ${getAllVocab().length} Vokabeln</div>
    </div>

    <div class="cat-scroll">
      ${cats.map(c => `<button class="cat-btn ${c===currentCat?'active':''}" onclick="currentCat='${c.replace(/'/g,"\\'")}'; buildDeck(); render();">${c}${c!=='Alle' ? ' ('+VOCAB[c].length+')' : ' ('+getAllVocab().length+')'}</button>`).join('')}
    </div>

    <div class="mode-tabs">
      <button class="mode-tab ${mode==='jp-de'?'active':''}" onclick="mode='jp-de'; buildDeck(); render();">üáØüáµ ‚Üí üá©üá™</button>
      <button class="mode-tab ${mode==='de-jp'?'active':''}" onclick="mode='de-jp'; buildDeck(); render();">üá©üá™ ‚Üí üáØüáµ</button>
    </div>

    <label class="shuffle-toggle" onclick="event.stopPropagation();">
      <input type="checkbox" ${shuffle?'checked':''} onchange="shuffle=this.checked; buildDeck(); render();"> Zuf√§llige Reihenfolge
    </label>

    <div class="stats">
      <div><span class="stat-num">${currentIndex + 1}</span> <span class="stat-label">/ ${total}</span></div>
      <div class="progress-wrap"><div class="progress-bar"><div class="progress-fill" style="width:${progress}%"></div></div></div>
      <div><span class="stat-num" style="color:#4ade80">${knownCount}</span> <span class="stat-label">‚úì</span> &nbsp;<span class="stat-num" style="color:#f87171">${againCount}</span> <span class="stat-label">‚úó</span></div>
    </div>

    ${reviewingAgain ? '<div class="direction-info" style="color:#f59e0b;">üîÅ Wiederholung der nicht gewussten Karten</div>' : ''}

    <div class="card-container" onclick="flipCard()">
      <div class="card-wrapper">
        <div class="card ${flipped ? 'flipped' : ''}">
          <div class="card-face card-front">
            <div class="card-label">${frontLabel}</div>
            <div class="card-jp" style="${mode==='de-jp'?'font-family:Inter,sans-serif;font-size:1.6rem;':''}">${front || ''}</div>
            ${mode==='jp-de' && current ? '<div class="card-romaji">'+current.rm+'</div>' : ''}
            <div class="tap-hint">Tippen zum Aufdecken</div>
          </div>
          <div class="card-face card-back">
            <div class="card-label">${backLabel}</div>
            <div class="${mode==='jp-de'?'card-de':'card-jp'}">${back || ''}</div>
            ${mode==='de-jp' && current ? '<div class="card-de-small">'+current.rm+'</div>' : ''}
          </div>
        </div>
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-again" ${!flipped?'disabled':''} onclick="event.stopPropagation(); markAgain();">‚úó Nochmal</button>
      <button class="btn btn-good" ${!flipped?'disabled':''} onclick="event.stopPropagation(); markKnown();">‚úì Gewusst</button>
    </div>

    <div class="shortcuts">
      <kbd>Leertaste</kbd> Aufdecken &nbsp; <kbd>‚Üê</kbd> Nochmal &nbsp; <kbd>‚Üí</kbd> Gewusst
    </div>
  `;
}

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (done) return;
  if (e.code === 'Space') { e.preventDefault(); if (!flipped) flipCard(); }
  if (e.code === 'ArrowRight' && flipped) markKnown();
  if (e.code === 'ArrowLeft' && flipped) markAgain();
});

// Init
buildDeck();
render();
</script>
</body>
</html>
